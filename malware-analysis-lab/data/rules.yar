rule Suspicious_Strings {
    meta:
        description = "Detects common suspicious strings in malware"
        author = "Basic Malware Analysis Lab"
        date = "2024"

    strings:
        $cmd_shell = "cmd.exe" nocase
        $powershell = "powershell.exe" nocase
        $wmic = "wmic" nocase
        $net_user = "net user" nocase
        $system32 = "system32" nocase
        $suspicious_extensions = /\.(exe|dll|bat|ps1|vbs|js)$/ nocase

    condition:
        any of them
}

rule High_Entropy_Section {
    meta:
        description = "Detects sections with high entropy (possible packed/encrypted content)"
        author = "Basic Malware Analysis Lab"
        date = "2024"

    condition:
        pe.sections[0].entropy > 7.0
}

rule Suspicious_Imports {
    meta:
        description = "Detects suspicious Windows API imports"
        author = "Basic Malware Analysis Lab"
        date = "2024"

    strings:
        $suspicious_apis = /(CreateRemoteThread|VirtualAlloc|WriteProcessMemory|ShellExecute|WinExec|CreateProcess)/ nocase

    condition:
        any of them
}

rule Anti_Debug {
    meta:
        description = "Detects common anti-debugging techniques"
        author = "Basic Malware Analysis Lab"
        date = "2024"

    strings:
        $is_debugger_present = "IsDebuggerPresent" nocase
        $check_remote_debugger = "CheckRemoteDebuggerPresent" nocase
        $nt_global_flag = "NtGlobalFlag" nocase

    condition:
        any of them
}
